@model SuccessViewModel
@{
    ViewData["Title"] = "Success";
}


<div class="text-center bg-light container p-5 vh-50 m-auto">
    <h3 class="mb-2">The shortened URL has been generated successfully.</h3>

    <p class="shortenedUrl">@Model.ShortenedUrl</p>

    <div class="d-flex mt-3 justify-content-between w-25 m-auto">
        <a class="btn btn-primary copy-btn">Copy URL</a>
        <a class="btn btn-primary" asp-controller="Home" asp-action="Index">Back to Home</a>
    </div>
</div>

@section Scripts {
    <script>
        document.querySelector('.copy-btn').addEventListener('click', function() {
            const urlText = document.querySelector('.shortenedUrl').innerText;
            if(navigator.clipboard?.writeText){
                navigator.clipboard.writeText(urlText)
                .then(() => alert('URL copied to clipboard!'))
                .catch(() => fallback(urlText));
            }
            else{
                fallback(urlText);
            }
        });

        function fallback(text){
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";

            document.body.appendChild(textArea);
            textArea.select();
            try{
                document.execCommand("copy");
                alert("URL copied to clipboaed!");
            }catch(err){
                console.log("Unable ot copy.");
                alert("Failed to copy URL. Please copy manually.");
            }

            document.body.removeChild(textArea);
        }
    </script>
}